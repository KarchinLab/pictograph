model {
	for (i in 1:I) {
		for (s in 1:S) {
			y[i, s] ~ dbin(theta[i,s], n[i,s])
			theta[i, s] <- m[i,s] * w[i,s] / (tcn[i,s] * w[i,s] + 2*(1 - w[i,s]))
			w[i, s] ~ dbeta(a[z[i],s], b[z[i],s])
		}
		z[i] ~ dcat(pi[1:K])
	}
	
	pi[1:K] ~ ddirch(alpha[1:K])
	alpha <- rep(1, K)

	a_gamma <- 2
	b_gamma <- 10
	for (k in 1:K) {
		for (s in 1:S) {
			a[k,s] ~ dgamma(a_gamma, 1/b_gamma)
			b[k,s] ~ dgamma(a_gamma, 1/b_gamma)
		}
	}
}